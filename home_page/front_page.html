<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>shopbeha.com - The Most Comfortable Bra</title>
    <meta name="description"
        content="ShopBeha offers the most comfortable bras, panties, and maternity wear. Celebrate every body with our inclusive and stylish collection.">
    <meta property="og:title" content="shopbeha.com - The Most Comfortable Bra">
    <meta property="og:description"
        content="ShopBeha offers the most comfortable bras, panties, and maternity wear. Celebrate every body with our inclusive and stylish collection.">
    <meta property="og:image" content="https://shopbeha.com/images/og-image.jpg">
    <meta property="og:url" content="https://shopbeha.com/">
    <meta property="og:type" content="website">
    <link rel="canonical" href="https://shopbeha.com/">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Playfair+Display:wght@700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/front_page.css">
    <style>
        /* Extra safety to ensure modals are hidden by default */
        .modal {
            display: none !important;
        }

        .modal.show-right,
        .modal.show {
            display: flex !important;
        }
    </style>
</head>

<body>
    <%- include('header.html') %>

        <!-- Home Page -->
        <section id="home" class="page active" style="padding: 0; max-width: none;">
            <%- include('hero.html') %>

                <!-- Customer Love Section -->
                <%- include('customer_love.html') %>

                    <div style="max-width: 1400px; margin: 0 auto; padding: 4rem 5%;">
                        <%- include('trail_favorites.html') %>
                    </div>

                    <!-- New Arrivals Section -->
                    <section class="new-arrivals-section">
                        <div class="new-arrivals-bg"></div>
                        <div class="new-arrivals-card">
                            <h2>New Arrivals!</h2>
                            <p>Discover our latest designs that celebrate every body.</p>
                            <p>Claim 15% off if you buy 2 or more items!</p>

                        </div>
                    </section>
        </section>

        <%- include('value_props.html') %>
            <%- include('newsletter.html') %>
                <%- include('footer.html') %>

                    <%- include('../admin_panel/cart_modal.html') %>
                        <%- include('../admin_panel/checkout_modal.html') %>
                            <%- include('../admin_panel/edit_trail_favorites_modal.html') %>
                                <%- include('../admin_panel/add_product_modal.html') %>
                                    <%- include('login_modal.html') %>

                                        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
                                        <script src="js/supabase-init.js"></script>
                                        <script src="js/auth.js"></script>
                                        <script src="home_page/js/account-popup.js"></script>
                                        <script src="js/cart.js"></script>
                                        <script src="js/shopbeha.js"></script>

                                        <script src="js/notifications.js"></script>
                                        <script src="js/newsletter.js"></script>
                                        <link rel="stylesheet" href="home_page/css/notifications.css">

                                        <script>
                                            // Page-specific logic for Home Page

                                            // Initialize the page
                                            document.addEventListener('DOMContentLoaded', function () {
                                                renderTrailFavorites();
                                                populateProductLists();
                                            });

                                            // Render Trail Favorites on the homepage
                                            function renderTrailFavorites() {
                                                const container = document.getElementById('trail-favorites-container');
                                                if (!container) return;
                                                container.innerHTML = '';

                                                let trailFavorites = products.filter(product => product.isTrailFavorite);

                                                // Fallback: If no favorites are set, show the first 8 products
                                                if (trailFavorites.length === 0 && products.length > 0) {
                                                    trailFavorites = products.slice(0, 8);
                                                }

                                                trailFavorites.forEach(product => {
                                                    const productCard = document.createElement('div');
                                                    productCard.className = 'product-card';

                                                    // Generate star rating
                                                    const fullStars = Math.floor(product.rating);
                                                    const halfStar = product.rating % 1 >= 0.5;
                                                    let stars = '';

                                                    for (let i = 0; i < fullStars; i++) {
                                                        stars += '★';
                                                    }

                                                    if (halfStar) {
                                                        stars += '½';
                                                    }

                                                    const emptyStars = 5 - Math.ceil(product.rating);
                                                    for (let i = 0; i < emptyStars; i++) {
                                                        stars += '☆';
                                                    }

                                                    const safeName = escapeHTML(product.name);
                                                    const safeJSName = escapeJS(product.name);
                                                    productCard.innerHTML = `
                <div class="product-image" onclick="openProductPage(${product.id}, '${safeJSName}', ${product.price})">
                    <img src="${product.image}" alt="${safeName}" class="main-img" loading="lazy">
                    ${product.hoverImage ? `<img src="${product.hoverImage}" alt="${safeName} hover" class="hover-img" loading="lazy">` : ''}
                    <button class="edit-product-btn" onclick="event.stopPropagation(); openEditProductModal(${product.id})">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
                    </button>
                </div>
                <div class="product-info">
                    <h3>${safeName}</h3>
                    <div class="rating" aria-label="Rated ${product.rating} out of 5">${stars} (${product.rating}/5)</div>
                    <div class="price">R ${product.price.toFixed(2)}</div>
                    <button class="add-button" aria-label="View details for ${safeName}" onclick="openProductPage(${product.id}, '${safeJSName}', ${product.price})">ADD TO CART</button>
                </div>
            `;

                                                    container.appendChild(productCard);
                                                });
                                            }

                                            // Populate product lists in the admin modal
                                            function populateProductLists() {
                                                const availableProductsList = document.getElementById('available-products');
                                                const trailFavoritesList = document.getElementById('trail-favorites-list');

                                                if (!availableProductsList || !trailFavoritesList) return;

                                                availableProductsList.innerHTML = '';
                                                trailFavoritesList.innerHTML = '';

                                                products.forEach(product => {
                                                    const productItem = document.createElement('div');
                                                    productItem.className = 'product-list-item';
                                                    const safeName = escapeHTML(product.name);
                                                    productItem.innerHTML = `
                <span>${safeName} - R ${product.price.toFixed(2)}</span>
                <div class="product-list-actions">
                    ${product.isTrailFavorite ?
                                                            `<button class="delete-btn" onclick="removeFromTrailFavorites(${product.id})">Remove</button>` :
                                                            `<button class="edit-btn" onclick="addToTrailFavorites(${product.id})">Add</button>`
                                                        }
                </div>
            `;

                                                    if (product.isTrailFavorite) {
                                                        trailFavoritesList.appendChild(productItem);
                                                    } else {
                                                        availableProductsList.appendChild(productItem);
                                                    }
                                                });
                                            }

                                            // Add product to Trail Favorites
                                            function addToTrailFavorites(productId) {
                                                const product = products.find(p => p.id === productId);
                                                if (product) {
                                                    product.isTrailFavorite = true;
                                                    saveProductsToStorage();
                                                    populateProductLists();
                                                    renderTrailFavorites();
                                                }
                                            }

                                            // Remove product from Trail Favorites
                                            function removeFromTrailFavorites(productId) {
                                                const product = products.find(p => p.id === productId);
                                                if (product) {
                                                    product.isTrailFavorite = false;
                                                    saveProductsToStorage();
                                                    populateProductLists();
                                                    renderTrailFavorites();
                                                }
                                            }

                                            // Save Trail Favorites changes
                                            function saveTrailFavorites() {
                                                saveProductsToStorage();
                                                renderTrailFavorites();
                                                closeModal('editTrailFavoritesModal');
                                                window.showNotification('Favorites updated successfully!', 'success');
                                            }

                                            // Form Handling for Add Product
                                            const addProductForm = document.getElementById('addProductForm');
                                            if (addProductForm) {
                                                addProductForm.addEventListener('submit', function (e) {
                                                    e.preventDefault();
                                                    const newProduct = {
                                                        id: products.length ? Math.max(...products.map(p => p.id)) + 1 : 1,
                                                        name: document.getElementById('productName').value,
                                                        price: parseFloat(document.getElementById('productPrice').value),
                                                        rating: Math.max(1, Math.min(5, parseFloat(document.getElementById('productRating').value))),
                                                        category: document.getElementById('productCategory').value,
                                                        isTrailFavorite: false
                                                    };
                                                    products.push(newProduct);
                                                    saveProductsToStorage();
                                                    window.showNotification('Product added successfully!', 'success');
                                                    closeModal('addProductModal');
                                                    populateProductLists();
                                                    addProductForm.reset();
                                                });
                                            }
                                        </script>

                                        <!-- Search Modal -->
                                        <div id="searchModal" class="modal" style="display:none;">
                                            <div class="modal-content search-panel">
                                                <div class="search-header"
                                                    style="display:flex; justify-content:space-between; margin-bottom:1rem;">
                                                    <h2>Search Products</h2>
                                                    <button class="cancel-btn" onclick="closeModal('searchModal')"
                                                        style="background:none; border:none; font-size:1.5rem; cursor:pointer;">×</button>
                                                </div>
                                                <div class="search-input-container">
                                                    <input id="searchInput" type="text"
                                                        placeholder="Search for products..." autocomplete="off">
                                                </div>
                                                <div id="searchResults" class="search-results" style="margin-top:1rem;">
                                                </div>
                                            </div>
                                        </div>
</body>

</html>